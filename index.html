<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ì‘ì€ í–‰ë™ì˜ ì‹¬ë¦¬í•™ â€” ë§ˆìŒì´ ë°”ê¾¸ëŠ” ì§€êµ¬</title>

<!-- ì›¹í°íŠ¸ (ë‘¥ê·¼ ê³ ë”• ê³„ì—´ ëŠë‚Œ) -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --ivory: #F7F4EE;
    --pastel-blue: #C7E7FF;
    --muted-blue: #9CC8E7;
    --accent: #6AA6D6;
    --text: #2C3A3A;
    --card: #ffffff;
    --glass: rgba(255,255,255,0.7);
    --radius: 14px;
    --shadow: 0 6px 18px rgba(38,50,56,0.08);
    --max-width: 1100px;
  }

  /* ê¸°ë³¸ ë¦¬ì…‹ */
  *{box-sizing: border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, var(--ivory) 0%, #F2F7FB 100%);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    line-height:1.55;
    scroll-behavior:smooth;
  }

  /* ì „ì²´ ë ˆì´ì•„ì›ƒ */
  .container{
    max-width:var(--max-width);
    margin:0 auto;
    padding:40px 20px;
  }

  /* ë„¤ë¹„ê²Œì´ì…˜ */
  header{
    position:fixed;
    left:0; right:0;
    top:16px;
    display:flex;
    justify-content:center;
    z-index:40;
    pointer-events:none;
  }
  nav{
    pointer-events:all;
    background:rgba(255,255,255,0.7);
    backdrop-filter: blur(6px);
    border-radius:999px;
    padding:8px 14px;
    box-shadow:var(--shadow);
    display:flex;
    gap:8px;
    align-items:center;
  }
  nav a{
    text-decoration:none;
    color:var(--text);
    font-weight:600;
    padding:8px 12px;
    border-radius:999px;
  }
  nav a:hover, nav a:focus{
    background:var(--pastel-blue);
    outline:none;
  }

  /* ì„¹ì…˜ ê³µí†µ */
  section.full{
    min-height:100vh;
    display:grid;
    grid-template-columns:1fr;
    align-items:center;
    padding:80px 0;
    width:100%;
  }

  /* Hero */
  .hero{
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding: 60px 20px;
  }
  .hero .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.9));
    border-radius:24px;
    padding:48px;
    box-shadow:var(--shadow);
    max-width:980px;
    width:100%;
    backdrop-filter: blur(4px);
  }
  .title{
    font-size:clamp(26px, 4vw, 44px);
    line-height:1.05;
    margin:0 0 12px 0;
    color:var(--text);
  }
  .subtitle{
    margin:0;
    font-size:clamp(14px, 1.6vw, 18px);
    color:#3b5258;
  }
  .hero-cta{
    margin-top:18px;
    display:flex;
    gap:12px;
    justify-content:center;
    flex-wrap:wrap;
  }
  .btn{
    padding:10px 16px;
    border-radius:999px;
    border:0;
    cursor:pointer;
    font-weight:700;
    background:var(--accent);
    color:white;
    box-shadow: 0 8px 20px rgba(106,166,214,0.18);
  }
  .btn.secondary{
    background:transparent;
    color:var(--text);
    border:2px solid rgba(0,0,0,0.05);
  }

  /* 2-column layout for about & campaigns */
  .two-col{
    display:grid;
    grid-template-columns: 1fr 430px;
    gap:28px;
    align-items:start;
  }
  @media (max-width:980px){
    .two-col{grid-template-columns:1fr; padding:0 12px}
  }

  /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
  .card-small{
    background:var(--card);
    border-radius:16px;
    padding:18px;
    box-shadow:var(--shadow);
  }

  /* ì‹¬ë¦¬ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ */
  .psych-grid{
    display:grid;
    gap:12px;
    grid-template-columns:repeat(auto-fit, minmax(220px,1fr));
  }

  .psych-item{
    padding:14px;
    border-radius:12px;
    background:linear-gradient(180deg, rgba(199,231,255,0.25), rgba(255,255,255,0.6));
  }
  .psych-item h4{margin:0 0 6px 0}
  .psych-item p{margin:0;font-size:14px;color:#2f4b4b}

  /* ìº í˜ì¸ ì°¸ì—¬ ì„¹ì…˜ */
  .campaign{
    display:flex;
    flex-direction:column;
    gap:14px;
  }
  .campaign form{
    display:flex;
    gap:8px;
    align-items:center;
    margin-top:6px;
    flex-wrap:wrap;
  }
  input[type="text"], select, textarea{
    padding:10px 12px;
    border-radius:10px;
    border:1px solid rgba(0,0,0,0.06);
    font-size:14px;
    min-width:180px;
  }
  textarea{min-height:80px; resize:vertical;}
  .small{
    font-size:13px; color:#4b6466;
  }

  /* ì°¸ê°€ ê¸°ë¡ ëª©ë¡ */
  .records{
    margin-top:10px;
    display:flex;
    flex-direction:column;
    gap:8px;
    max-height:260px;
    overflow:auto;
    padding-right:6px;
  }
  .record{
    display:flex;
    justify-content:space-between;
    gap:10px;
    align-items:center;
    padding:10px;
    background:var(--glass);
    border-radius:10px;
  }

  /* ìŠ¤í† ë¦¬ ë¸”ë¡œê·¸í˜• */
  .stories{
    display:grid;
    gap:16px;
    grid-template-columns:repeat(auto-fit, minmax(260px,1fr));
  }
  .story{
    padding:16px;
    border-radius:12px;
    background:linear-gradient(180deg,#fff, #F8FBFF);
    box-shadow:var(--shadow);
  }
  .story h3{margin:0 0 6px 0}
  .story p{margin:0 0 8px 0; color:#3b5356; font-size:14px}

  /* êµìœ¡ ì„¹ì…˜ (ì‹¬ë¦¬í•™ ì´ë¡ ) */
  .edu-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(220px,1fr));
    gap:12px;
  }

  /* footer */
  footer{
    text-align:center;
    padding:36px 12px;
    color:#4a5a5a;
  }

  /* reveal animation */
  .reveal{
    opacity:0;
    transform:translateY(18px) scale(0.995);
    transition: all 700ms cubic-bezier(.2,.9,.3,1);
  }
  .reveal.visible{
    opacity:1;
    transform:none;
  }

  /* progress indicator on side */
  .progress{
    position:fixed;
    right:14px;
    top:50%;
    transform:translateY(-50%);
    background:rgba(255,255,255,0.8);
    padding:8px;
    border-radius:12px;
    box-shadow:var(--shadow);
    display:flex;
    flex-direction:column;
    gap:8px;
    z-index:40;
  }
  .progress .dot{width:10px;height:10px;border-radius:50%;background:#ddd}
  .progress .dot.active{background:var(--accent)}

  /* small utilities */
  .muted{color:#627878}
  .flex{display:flex;gap:10px;align-items:center}
  .center{display:flex;justify-content:center;align-items:center}
</style>
</head>
<body>

<header>
  <nav aria-label="í˜ì´ì§€ ë‚´ë¹„ê²Œì´ì…˜">
    <a href="#home">í™ˆ</a>
    <a href="#about">ì‹¬ë¦¬í•™ ì†Œê°œ</a>
    <a href="#campaigns">ìº í˜ì¸</a>
    <a href="#stories">ìŠ¤í† ë¦¬</a>
    <a href="#learn">í•™ìŠµ</a>
  </nav>
</header>

<!-- progress dots -->
<div class="progress" aria-hidden="true">
  <div class="dot" data-target="#home"></div>
  <div class="dot" data-target="#about"></div>
  <div class="dot" data-target="#campaigns"></div>
  <div class="dot" data-target="#stories"></div>
  <div class="dot" data-target="#learn"></div>
</div>

<!-- HERO -->
<section id="home" class="full">
  <div class="container hero reveal">
    <div class="card">
      <h1 class="title">ì‘ì€ í–‰ë™ì˜ ì‹¬ë¦¬í•™<br><span style="color:var(--accent)">â€” ë§ˆìŒì´ ë°”ê¾¸ëŠ” ì§€êµ¬</span></h1>
      <p class="subtitle">ì‹¬ë¦¬í•™ì˜ ì›ë¦¬ë¥¼ í†µí•´ ì¹œí™˜ê²½ í–‰ë™ì„ ì¼ìƒìœ¼ë¡œ ì—°ê²°í•˜ëŠ” ìº í˜ì¸, êµìœ¡, ì´ì•¼ê¸°ë“¤ì„ í•œ ê³³ì— ëª¨ì•˜ìŠµë‹ˆë‹¤.</p>

      <div class="hero-cta">
        <button class="btn" onclick="document.querySelector('#campaigns').scrollIntoView({behavior:'smooth'})">ìº í˜ì¸ ì°¸ì—¬í•˜ê¸°</button>
        <button class="btn secondary" onclick="document.querySelector('#about').scrollIntoView({behavior:'smooth'})">ì‹¬ë¦¬í•™ ì›ë¦¬ ë³´ê¸°</button>
      </div>
    </div>
  </div>
</section>

<!-- ABOUT (ì‹¬ë¦¬ ì›ë¦¬) -->
<section id="about" class="full" aria-labelledby="about-title">
  <div class="container reveal two-col">
    <div>
      <h2 id="about-title">ì‹¬ë¦¬í•™ìœ¼ë¡œ ë³¸ í™˜ê²½ í–‰ë™</h2>
      <p class="muted">í™˜ê²½ í–‰ë™ì„ ë°©í•´í•˜ëŠ” ë§ˆìŒì˜ ì¥ë²½ì„ ì´í•´í•˜ë©´, ë” íš¨ê³¼ì ìœ¼ë¡œ í–‰ë™ ë³€í™”ë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

      <div class="psych-grid" style="margin-top:18px;">
        <div class="psych-item card-small">
          <h4>í™•ì¦ í¸í–¥</h4>
          <p>ì‚¬ëŒë“¤ì€ ê¸°ì¡´ ì‹ ë…ì— ë§ëŠ” ì •ë³´ë§Œ ë°›ì•„ë“¤ì…ë‹ˆë‹¤. 'ë‚´ê°€ í•  í•„ìš” ì—†ë‹¤'ëŠ” ìƒê°ì„ ë°”ê¾¸ëŠ” ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="psych-item card-small">
          <h4>ì¸ì§€ ë¶€ì¡°í™”</h4>
          <p>í™˜ê²½ ê°€ì¹˜ì™€ í˜„ì‹¤ í–‰ë™ ê°„ ë¶ˆì¼ì¹˜ë¥¼ ê²½í—˜í•˜ë©´ ë¶ˆí¸ì„ ëŠë‚ë‹ˆë‹¤. ì‘ì€ ì¼ë¶€í„° í–‰ë™ ì¼ì¹˜ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="psych-item card-small">
          <h4>ì‹¬ë¦¬ì  ê±°ë¦¬ê°</h4>
          <p>ë¬¸ì œê°€ 'ë‚˜'ì™€ ë©€ê²Œ ëŠê»´ì§€ë©´ í–‰ë™ìœ¼ë¡œ ì˜®ê¸°ê¸° ì–´ë µìŠµë‹ˆë‹¤. ê°ì •ì  ì—°ê²°(ìŠ¤í† ë¦¬)ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="psych-item card-small">
          <h4>ì‚¬íšŒì  ì¦ê±°</h4>
          <p>ë‹¤ë¥¸ ì‚¬ëŒì´ í•˜ë©´ ë‚˜ë„ í•˜ê²Œ ë©ë‹ˆë‹¤. ì¹œêµ¬Â·ì§€ì—­ ë‹¨ìœ„ì˜ ì°¸ì—¬ ìœ ì¸ì±…ì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.</p>
        </div>
      </div>
    </div>

    <aside>
      <div class="card-small">
        <h3>í•µì‹¬ ìº í˜ì¸</h3>
        <ol class="small">
          <li><strong>ë‚˜ì˜ í•˜ë£¨ í•œ í–‰ë™</strong> â€“ ìê¸°íš¨ëŠ¥ê° ê°•í™”</li>
          <li><strong>ì¹œêµ¬ì™€ ê°™ì´ ì—ì½” í¬ì¸íŠ¸</strong> â€“ ì‚¬íšŒì  ì¦ê±° í™œìš©</li>
          <li><strong>ì§€êµ¬ì—ê²Œ í¸ì§€ ì“°ê¸°</strong> â€“ ê°ì • ì´ì… ìœ ë„</li>
        </ol>
        <p class="small muted" style="margin-top:8px">ì•„ë˜ì˜ 'ìº í˜ì¸' ì„¹ì…˜ì—ì„œ ì§ì ‘ ì°¸ì—¬í•˜ê³  ê¸°ë¡í•˜ì„¸ìš”.</p>
      </div>
    </aside>
  </div>
</section>

<!-- CAMPAIGNS (ì°¸ì—¬í˜•) -->
<section id="campaigns" class="full" aria-labelledby="camp-title">
  <div class="container reveal">
    <h2 id="camp-title">ìº í˜ì¸ ì°¸ì—¬í•˜ê¸°</h2>
    <p class="muted">ì‘ì€ í–‰ë™ì„ ê¸°ë¡í•˜ê³ , ë°°ì§€ì™€ í”¼ë“œë°±ì„ ë°›ì•„ë³´ì„¸ìš”. ê¾¸ì¤€í•¨ì´ ë³€í™”ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>

    <div class="campaign" style="margin-top:18px;">
      <div class="card-small">
        <strong>ì°¸ì—¬ ì–‘ì‹</strong>
        <form id="actionForm" onsubmit="submitAction(event)" aria-label="ìº í˜ì¸ ì°¸ì—¬ í¼">
          <input id="actName" type="text" placeholder="ë‹¹ì‹ ì˜ ì´ë¦„ (ì„ íƒ)" aria-label="ì´ë¦„ (ì„ íƒ)">
          <select id="actType" aria-label="í–‰ë™ ìœ í˜•">
            <option value="recycle">ë¶„ë¦¬ìˆ˜ê±°/ì¬í™œìš©</option>
            <option value="reduce">ì¼íšŒìš© ì¤„ì´ê¸°</option>
            <option value="transport">ëŒ€ì¤‘êµí†µ/ë„ë³´/ìì „ê±°</option>
            <option value="energy">ì „ê¸°/ì—ë„ˆì§€ ì ˆì•½</option>
            <option value="other">ê¸°íƒ€</option>
          </select>
          <input id="actNote" type="text" placeholder="êµ¬ì²´ì  í–‰ë™(ì˜ˆ: ë¹¨ëŒ€ ì‚¬ìš© ì•ˆí•¨)" required aria-required="true">
          <button class="btn" type="submit">ê¸°ë¡í•˜ê¸°</button>
        </form>
        <p class="small muted" style="margin-top:10px">ë…¹ìƒ‰ ë°°ì§€ëŠ” 3íšŒ ê¸°ë¡ ì‹œ íšë“ë©ë‹ˆë‹¤. ê¸°ë¡ì€ ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
      </div>

      <div class="card-small" aria-live="polite" id="feedbackArea" style="display:none;">
        <strong>í”¼ë“œë°±</strong>
        <p id="feedbackText" class="small"></p>
      </div>

      <div class="card-small">
        <strong>ë‚´ ê¸°ë¡</strong>
        <div id="records" class="records" aria-live="polite"></div>
      </div>

      <div class="card-small">
        <strong>ì°¸ì—¬ íŒ</strong>
        <ul class="small">
          <li>ì‘ì€ í–‰ë™ì´ë¼ë„ ë§¤ì¼ ê¸°ë¡í•˜ë©´ ìŠµê´€ì´ ë©ë‹ˆë‹¤.</li>
          <li>ì¹œêµ¬ë¥¼ ì´ˆëŒ€í•´ í•¨ê»˜ í•˜ë©´ ë” ì˜¤ë˜ ì§€ì†ë©ë‹ˆë‹¤.</li>
          <li>ìê¸°íš¨ëŠ¥ê°ì„ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ì„±ì·¨ë¥¼ í‘œì‹œí•´ë³´ì„¸ìš”.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- STORIES (ë¸”ë¡œê·¸/ìŠ¤í† ë¦¬) -->
<section id="stories" class="full" aria-labelledby="stories-title">
  <div class="container reveal">
    <h2 id="stories-title">ì‘ì€ ì´ì•¼ê¸°ë“¤ â€” ì—ì½” ìŠ¤í† ë¦¬</h2>
    <p class="muted">ì‚¬ëŒë“¤ì´ í™˜ê²½ê³¼ ì—°ê²°ë˜ë©° ê²ªì€ ì‘ì€ ë³€í™”ì˜ ì´ì•¼ê¸°ì…ë‹ˆë‹¤.</p>

    <div style="margin-top:18px;" class="stories">
      <!-- ì˜ˆì‹œ ìŠ¤í† ë¦¬ë“¤ -->
      <article class="story">
        <h3>í•œ ì£¼ì˜ ë³€í™”</h3>
        <p>í”Œë¼ìŠ¤í‹± ì»µ ëŒ€ì‹  í…€ë¸”ëŸ¬ë¥¼ ë“¤ê³  ë‹¤ë‹Œ ì§€ í•œ ë‹¬. ìƒê°ë³´ë‹¤ ë§ˆìŒì´ ê°€ë²¼ì›Œì¡Œì–´ìš”.</p>
        <p class="small muted">â€” ìˆ˜ì—°</p>
      </article>

      <article class="story">
        <h3>í•¨ê»˜í•œ ë™ë„¤ ìº í˜ì¸</h3>
        <p>ìš°ë¦¬ ë™ë„¤ ì²­ì†Œë…„ë“¤ì´ ëª¨ì—¬ ì“°ë ˆê¸° ì¤ê¸°ë¥¼ í–ˆìŠµë‹ˆë‹¤. ëŒ€í™”ê°€ ë§ì´ ìƒê²¼ì–´ìš”.</p>
        <p class="small muted">â€” ë¯¼ì¤€</p>
      </article>

      <article class="story">
        <h3>ì§€êµ¬ì—ê²Œ ì“´ í¸ì§€</h3>
        <p>â€œë¯¸ì•ˆí•´. ê·¸ë¦¬ê³  ê³ ë§ˆì›Œ.â€ë¼ê³  ì“´ ë’¤ì— ì§„ì§œ í–‰ë™ì´ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤.</p>
        <p class="small muted">â€” ìˆ˜ì •</p>
      </article>
    </div>
  </div>
</section>

<!-- LEARN (êµìœ¡ ì„¹ì…˜) -->
<section id="learn" class="full" aria-labelledby="learn-title">
  <div class="container reveal two-col">
    <div>
      <h2 id="learn-title">ì‹¬ë¦¬í•™ìœ¼ë¡œ ë°°ìš°ëŠ” í™˜ê²½ ë³€í™”</h2>
      <p class="muted">ê´€ë ¨ ì´ë¡ ê³¼ ì‹¤ìš© íŒì„ ì§§ê²Œ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.</p>

      <div style="margin-top:18px" class="edu-grid">
        <div class="card-small">
          <h4>ì¸ì§€ ë¶€ì¡°í™”</h4>
          <p class="small">ê°€ì¹˜ì™€ í–‰ë™ì´ ì–´ê¸‹ë‚  ë•Œ ë¶ˆí¸í•¨ì„ ëŠë¼ì£ . ì‘ì€ í–‰ë™ ì¼ì¹˜ë¶€í„° ì‹œì‘í•˜ì„¸ìš”.</p>
        </div>
        <div class="card-small">
          <h4>í–‰ë™ ë³€í™” ë‹¨ê³„</h4>
          <p class="small">ê´€ì‹¬â†’ì¤€ë¹„â†’ì‹¤í–‰â†’ìœ ì§€ì˜ ë‹¨ê³„ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ê° ë‹¨ê³„ì— ë§ì¶˜ ì§€ì›ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="card-small">
          <h4>ìê¸°ê²°ì •ì´ë¡ </h4>
          <p class="small">ë‚´ì  ë™ê¸°(ì˜ë¯¸), ììœ¨ì„±, ìœ ëŠ¥ê°ì´ í–‰ë™ ì§€ì†ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.</p>
        </div>
      </div>
    </div>

    <aside>
      <div class="card-small">
        <h3>7ì¼ ë£¨í‹´ ìƒ˜í”Œ</h3>
        <ol class="small">
          <li>1ì¼ ì°¨: í…€ë¸”ëŸ¬ ì‚¬ìš©</li>
          <li>2ì¼ ì°¨: ì¥ë°”êµ¬ë‹ˆ ì§€ì°¸</li>
          <li>3ì¼ ì°¨: ëŒ€ì¤‘êµí†µ 1íšŒ</li>
          <li>... (ê³„ì†)</li>
        </ol>
        <p class="small muted" style="margin-top:8px">ì‘ì€ ì„±ê³µì„ ì ì–´ê°€ë©° ìê¸°íš¨ëŠ¥ê°ì„ í‚¤ì›Œë³´ì„¸ìš”.</p>
      </div>
    </aside>
  </div>
</section>

<footer>
  <div class="container">
    Â© 2025 ì‘ì€ í–‰ë™ì˜ ì‹¬ë¦¬í•™ â€” ë§ˆìŒì´ ë°”ê¾¸ëŠ” ì§€êµ¬ Â· êµìœ¡ìš© ë°ëª¨
  </div>
</footer>

<script>
/*
  JS ê¸°ëŠ¥:
   - í˜ì´ì§€ì˜ reveal ì• ë‹ˆë©”ì´ì…˜ (IntersectionObserver)
   - ìº í˜ì¸ ì°¸ì—¬ í¼(localStorage ì €ì¥)
   - ë°°ì§€ íšë“ ë¡œì§(3íšŒ -> ê·¸ë¦° ë°°ì§€)
   - progress dot í™œì„±í™”
   - ê°„ë‹¨í•œ í”¼ë“œë°± ë©”ì‹œì§€
*/

// Reveal on scroll
(function(){
  const io = new IntersectionObserver(entries=>{
    for(const e of entries){
      if(e.isIntersecting) e.target.classList.add('visible');
    }
  }, {threshold: 0.12});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
})();

// Progress dots
(function(){
  const dots = document.querySelectorAll('.progress .dot');
  const targets = Array.from(dots).map(d => document.querySelector(d.dataset.target));
  function update(){
    const scroll = window.scrollY + window.innerHeight/3;
    targets.forEach((el, i) => {
      if(!el) return;
      const rect = el.getBoundingClientRect();
      const top = window.scrollY + rect.top;
      const bottom = top + rect.height;
      if(scroll >= top && scroll < bottom){
        dots.forEach(x=>x.classList.remove('active'));
        dots[i].classList.add('active');
      }
    });
  }
  update();
  window.addEventListener('scroll', update, {passive:true});
})();

// Campaign logic
const STORAGE_KEY = 'eco_actions_v1';

function getRecords(){
  try{
    return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  } catch(e){
    console.error('localStorage read error', e);
    return [];
  }
}

function saveRecords(arr){
  try{
    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  } catch(e){
    console.error('localStorage write error', e);
  }
}

function formatTime(ts){
  const d = new Date(ts);
  return d.toLocaleString();
}

function renderRecords(){
  const container = document.getElementById('records');
  container.innerHTML = '';
  const recs = getRecords().slice().reverse(); // ìµœê·¼ ìš°ì„ 
  if(recs.length === 0){
    container.innerHTML = '<div class="small muted">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì‘ì€ í–‰ë™ì„ ê¸°ë¡í•´ë³´ì„¸ìš”!</div>';
    return;
  }
  recs.forEach(r=>{
    const div = document.createElement('div');
    div.className = 'record';
    div.innerHTML = `<div>
        <strong>${r.name ? r.name : 'ìµëª…'}</strong>
        <div class="small muted">${r.type.replace(/^\w/,c=>c.toUpperCase())} Â· ${formatTime(r.t)}</div>
        <div style="font-size:14px;margin-top:6px">${escapeHtml(r.note)}</div>
      </div>
      <div class="small muted">${r.badge ? 'ğŸ…' : ''}</div>`;
    container.appendChild(div);
  });
}

// escape to avoid injection in innerHTML
function escapeHtml(s){
  return String(s).replace(/[&<>"'`]/g, function(ch){
    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;', '`':'&#96;'})[ch];
  });
}

function submitAction(e){
  e.preventDefault();
  const name = document.getElementById('actName').value.trim();
  const type = document.getElementById('actType').value;
  const note = document.getElementById('actNote').value.trim();
  if(!note){
    alert('êµ¬ì²´ì  í–‰ë™ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
    return;
  }
  const recs = getRecords();
  const newRec = { name: name || null, type, note, t: Date.now(), badge: false };
  recs.push(newRec);

  // ë°°ì§€ ë¡œì§: ê°™ì€ 'ë¸Œë¼ìš°ì €'ì—ì„œ 3íšŒ ì´ìƒ ê¸°ë¡ ì‹œ badge ë¶€ì—¬
  const recentCount = recs.filter(r => r.type === type).length;
  if(recentCount >= 3){
    // mark unbadged items of that type as badge:true (simple behaviour)
    for(let i=recs.length-1;i>=0 && recentCount>0;i--){
      if(recs[i].type === type && !recs[i].badge){
        recs[i].badge = true;
      }
    }
  }

  saveRecords(recs);
  renderRecords();
  showFeedback(newRec, recentCount);

  // í´ë¦¬ì–´ í¼ í•„ë“œ
  document.getElementById('actNote').value = '';
}

// simple user feedback area
function showFeedback(rec, count){
  const area = document.getElementById('feedbackArea');
  const text = document.getElementById('feedbackText');
  area.style.display = 'block';
  let msg = '';
  if(rec.badge){
    msg = `ë©‹ì ¸ìš”! '${rec.note}' ë¥¼ ê¸°ë¡í–ˆì–´ìš”. ê°™ì€ ìœ í˜•ìœ¼ë¡œ ${count}íšŒ ê¸°ë¡ë˜ì–´ ê·¸ë¦° ë°°ì§€ë¥¼ íšë“í–ˆì–´ìš”! ğŸ…`;
  } else {
    msg = `ê¸°ë¡ ì™„ë£Œ: "${rec.note}". ê°™ì€ ìœ í˜•ì— ëŒ€í•´ ${count}/3íšŒì…ë‹ˆë‹¤. ê¾¸ì¤€íˆ ê¸°ë¡í•´ ë°°ì§€ë¥¼ ë°›ì•„ë³´ì„¸ìš”!`;
  }
  text.textContent = msg;

  // ê°„ë‹¨í•œ ì‹œê° í”¼ë“œë°± ì• ë‹ˆë©”ì´ì…˜
  area.animate([{transform:'translateY(-6px)', opacity:0},{transform:'translateY(0)', opacity:1}],{duration:380, easing:'cubic-bezier(.2,.9,.3,1')});
}

// ì´ˆê¸° ë¡œë“œ
document.addEventListener('DOMContentLoaded', ()=>{
  renderRecords();
  // ê¸°ë³¸ í”¼ë“œë°± ìˆ¨ê¸°ê¸°
  document.getElementById('feedbackArea').style.display = getRecords().length ? 'block' : 'none';

  // a[href^="#"] ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤(ë„¤ë¹„ ë§í¬)
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click',(ev)=>{
      const href = a.getAttribute('href');
      if(href.length > 1){
        ev.preventDefault();
        document.querySelector(href).scrollIntoView({behavior:'smooth'});
      }
    });
  });
});
</script>

</body>
</html>
